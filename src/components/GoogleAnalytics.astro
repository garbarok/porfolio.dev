---
/**
 * Google Analytics 4 Component
 * Standard implementation for reliable production deployment
 */

const GA_MEASUREMENT_ID = 'G-1J62NRCJ10'
const isProduction = import.meta.env.PROD
---

{isProduction && (
  <>
    <!-- Google tag (gtag.js) -->
    <script is:inline async src={`https://www.googletagmanager.com/gtag/js?id=${GA_MEASUREMENT_ID}`}></script>
    <script is:inline set:html={`
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', '${GA_MEASUREMENT_ID}');
    `} />

    <!-- View Transitions Support -->
    <script is:inline>
      document.addEventListener('astro:page-load', () => {
        if (typeof gtag !== 'undefined') {
          gtag('event', 'page_view', {
            page_path: window.location.pathname,
            page_title: document.title,
            page_location: window.location.href
          });
        }
      });
    </script>
  </>
)}
